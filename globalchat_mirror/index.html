<!doctype html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="icon" type="image/x-icon" sizes="32x32" href="https://kirka.lukeskywalk.com/favicon.ico">
    <meta property="og:title" content="kirka.lukeskywalk.com: a lightweight unofficial kirka.io global chat mirror.">
    <meta name="description" content="kirka.lukeskywalk.com: a lightweight unofficial  kirka.io global chat mirror.">
    <meta property="og:description" content="kirka.lukeskywalk.com: a lightweight unofficial  kirka.io global chat mirror.">
    <meta name="theme-color" content="#000000">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en_US">
    <meta name="twitter:card" content="summary_large_image">
    <title>kirka.io global chat mirror</title>
    <link rel="stylesheet" href="/static/bootstrap/5.3.0-alpha1/css/bootstrap.min.css" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD">
    <style>
        .nav-scroller {
            position: relative;
            z-index: 2;
            height: 2.75rem;
            overflow-y: hidden;
        }
        .nav-scroller .nav {
            display: flex;
            flex-wrap: nowrap;
            padding-bottom: 1rem;
            margin-top: -1px;
            overflow-x: auto;
            text-align: center;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }
    </style>
</head>
<body>
    <script fetchpriority="high" src="/static/bootstrap/5.3.0-alpha1/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"></script>
    <div class="container-fluid">
        <div id="chatter">
        </div>
        <div class="card fixed-end fixed-top col-sm-2 bg-dark-subtle">
            <div class="card-body">
                <div class="form-check">
                    <input class="form-check-input" onclick="autoscroll()" type="checkbox" id="autoscrolling" checked>
                    <label class="form-check-label" for="autoscrolling">autoscroll down</label>
                </div>
            </div>
        </div>
        <script>
            const itemTag = /(\[.*?\|.*?\|.*?\|.*?\]).*/i;
            const tradeTag = /(\*\*\/trade accept (\d.*?)\*\*)/i;
            const commonTag = /(\[.*?(\|.*?\||\|\|).*?\|COMMON\]).*/i;
            const rareTag = /(\[.*?(\|.*?\||\|\|?).*?\|RARE\]).*/i;
            const epicTag = /(\[.*?(\|.*?\||\|\|?).*?\|EPIC\]).*/i;
            const legendaryTag = /(\[.*?(\|.*?\||\|\|?).*?\|LEGENDARY\]).*/i;
            const mythicalTag = /(\[.*?(\|.*?\||\|\|?).*?\|MYTHICAL\]).*/i;
            const allItemsList = ['2022','22','Ace','Admiral','Alex','Alien Hazard','Alien','Amelia','Andromeda','AR-9','Aria','Artic Illusion','Atomic','Attention','Aubree','Awesome','Aztek','Basketcase','Bayonet','Bay','Beach','Bee','Beet','Beyona','Billion','Blackhole','Black Metal 2.0','Black Metal','Blackout','Bled','Blood Crystal','Bloody','Blueberry','Blue Hell','Boby','Boo','Brown','Bubblegum','Bunny','Bushido','Bush','Butterflies','Camilo','Camouflage','Candy Illusion','Candy','Cane','Carbon Fade','Cargo','Carrot','Case Hardened','Celebrate','Cereals','Champion','Checker','Cheesy','Cherry','Chess','Chocolate','Choco','Circuit','Cloudy','Clover','Cold','Colton','Complexity','Contrast','Coolas','Cosmos','Cover','Crash','Crazy','Crimson','Critical','Crosses','Crystal','Cult','Curry','Cyan','Cyberpunk','Cyber','DaBaby','Damascus','Dandelion','Danger','Darling','Destiny','Dissident','Dob','Donut','Easter','Egg Hunt','Elizabeth','Ellie','Elmoo','Emoo','Empress','Enderman','Engravement','Esto','Eva','Evening','Fabric','Fade','Fading Waves','Festive','Fire','Flo','Flow','Forest','Forge','Fortunado','Friendly','Frosty','Fun','Fur','Galaxy','Gem','George','Ghillie','Ghost','Gift','Gilded','Gingerman','Girls Band','Glacial','Glance','Globe','Goge','Gold Coins','Golden','Gold','Grass','Graya','Gray','Green','Greg','Grinch','Hadley','Hannah','Hardened','Heartbeat','Hearted','Heart','Hearts','Heatwave','Height','Hexagon','Hex','Hideyoshi','Hippy','Hologram','Hope','Hubbard','Hunter','Ice Cold','Ice','Infarction','Infra','Iron','Isolation','Ivoire','James','Jap','Karo','Keon','King','Kin','Kiss','Kod','Kyoto','Labyrinth','Land','LAR','Larry','Latern','Lava','Legend','Lemon','Leopard','LEO','Lightning','LOL','London','Lor','Loved','Love','Lucky','Lux','Lydia','M60','MAC-10','Machinery','Magic Splat','Magma','Magnum','Majestic','Major','Maksim','Malachite','Marbled','Mariah','Maria','Master','Maxwell','Maze','Melody','MemeStar','MemeStarTV','Metallic Rainbow','Metallic','Mili','Military','Milo','Mohito','Moira','Molten Core','Monkey','Mossy','Murdered','Mya','Mystic','Navy','Nebula','Neon','New Year','Noah','Noble','Noir','Normal Map','Nuclear Waste','Nyan Cat','Obsidian','Old','Orbit','Orchid','Or','Ostern','Owen','P-40','Pale','Papabear','Paques','Party','Pastel','Payton','PCB','Peachy','Pecan','Pegas','Peppermint','Picea','Pigo','Pineapple','Pine','Pink Camouflage','Pink Demon','Placate','Playdate','Playmate','Plum','Polar','Polygun','Present','Proton Beam','Psychedelic','Psycho','Pulse','Pumpkin','Questions','Rainbow','Rasta','Rebel','Redline','RedMoon','Red Reaper','Reindeer','Rein','Reptile','Republica','Retro','Retrowave','Revolver','RGB','Rogue','Rosed','Royalty','Ruby','Runes','Rusty','Ruth','S4TANSITO','Sady','Saint Patrick','Sakura','Saliman','Sam','Samurai','Santa Claus','Santa','Savage','Scale','Scarlet','SCAR','Sensei','Shard','Shark','Shiny','Simplicity','Skel','Skyboy','Sky','Sleep','Slime','Smoked','Snowman','Snowy','Soldiers','Spectacular','Spicy','Spilled','Spotted','Spring','Sprout','Starlinked','Steely','Striped','Stripes','Strips','Summer','Sunday','Sunflower','Sunset','Supermind','Swamp','Sweater','Tank','Teddy','Teflon','Terminator','Thalia','Tide','Tingey','Tomahawk','Tommy','Toxic','Toy','Tradition','Trolled','Try','Turquoise','TV','undefined','Universe','Valerie','Viking','Violet','VITA','Vivid','Void Ar9','Void Bayonet','Void Lar','Void M60','Void Mac10','Void Revolver','Void Scar','Void Shark','Void Tomahawk','Void Vita','Void Weatie','Volcano','Wacky','Waterfire','Watery','Wave Dot','Waveform','Weatie','Whiteout','Widow','Winter','Wity','Wood','Wrapping','Yellow Camo','Yule','Zebra','Zeke','Zelda','Zen','Zzzz'];
            const allItemsPrices = ["",9600000,"",2000,"",30000,50000,"",200000,"","","","","","","","",400000,"",275000,400000,"","","",400000,18000000,100000,"","",2850000,"","","","","",1400000,"","",2100000,2000000,"",15000000,"","","",4500000,2300000,"","","","",100000,"",30000000,"",600000,3500000,"",3000000,130000,"",30000,"","","","","","",600000,"","",4500000,"","","","","",1200000,"","","","",900000,"","","","",3000000,"","",2800000,480000,"","","","","","","","","","","","","",30000,"","","","",36000000,180000,"","","","","","","","","",2400000,"",10000000,"","","",50000,"","","",15000000,"","","","","",9700000,"","","",280000,600000,"",300000,"","","","",900000,"",600000,"","","","","",280000,"","","",280000,"","","","","",475000,15000000,5200000,50000,1800000,"","","","","",21600000,"","","",225000,2200000,"",2200000,800000,15000000,450000,"","","","",80000,"","","",300000,"","","","","","",9900000,"",1400000,"",150000,"","","","","","","","","","",120000,"","","","","","",5300000,"",450000,"","","",3100000,"",11500000,60000,700000,300000,2500000,"",1000000,"","",1100000,"","","",30000,"","","",800000,"","","","","","","","","","","","","",50000,6250000,"",400000,"","","","",600000,"","",100000,"","","",20000,700000,800000,"","",100000,500000,"","","","","","","","","","","",1000000,600000,"","","",80000,"",1800000,140000,"","","",1100000,"","","","","","","","","","","","",650000,300000,"","","","","","",480000,"",150000,"","",450000,30000,150000,"","","",30000,"","","",1000000,"",300000,"","","","","","","","","","",25000,"","","","","","","","","","","","","","","",4000000,"","","",300000,"","","",400000,"",400000,"","","",2000000,""];
            const shortItemsPrices = ["","9.6mil","","2K","","30k","50k","","200k","","","","","","","","","400k","","275k","400k","","","","400k","18mil","100k","","","2.85mil","","","","","","1.4mil","","","2.1mil","2mil","","15mil","","","","4.5mil","2.3mil","","","","","100k","","30mil","","600k","3.5mil","","3mil","130k","","30k","","500","","","","","600k","","","4.5mil","","","","","","1.2mil","","","","","900k","","","","","3mil","","","2.8mil","480k","","","","","300k","","","","","","","","","30k","","","","","36mil","180k","","","","","","","","","","2.4mil","","10mil","500","","150k","50k","","","1000","15mil","","","","","","9.7mil","","","","280k","600k","","300k","","","","","900k","","600k","","","","","500","280k","","","","280k","","","","","","475k","15mil","5.2mil","50k","1.8mil","","","","","","21.6mil","","","","225k","2.2mil","","2.2mil","800k","15mil","450k","","","","","80k","","","","300k","","","","","","","9.9mil","","1.4mil","","150k","","","","","","","","","","","120k","","","","","","","5.3mil","","450k","","","","3.1mil","","11.5mil","60k","700k","300k","2.5mil","","1mil","","","1.1mil","500","","","30k","","","","800k","","","","","","","280k","","400k","","","","","50k","6.25mil","","400k","","","","","600k","","","100k","","","","20k","700k","800k","","","100k","500k","","","","","","","","","","","","1mil","600k","","350k","","80k","","1.8mil","140k","","","","1.1mil","","","","","","","","500","","","","","650k","300k","","","","","","","480k","","150k","","","450k","30k","150k","","","","30k","","","","1mil","","300k","","","","","","","","","","","25k","","","","","","","","","","","","","","","","4mil","","","","300k","","","250","400k","","400k","","","","2mil",""];
            document.getElementById('autoscrolling').checked = true;
            const trimsplit = (x) => {
                let parts = [];
                let lastIndex = 0;
                for (let match of x.matchAll(/\[.*?\|.*?\|.*?\|.*?\]/g)) {
                    if (match.index !== lastIndex) {
                        parts.push(x.slice(lastIndex, match.index));
                    }
                    parts.push(match[0]);
                    lastIndex = match.index + match[0].length;
                } if (lastIndex !== x.length) {
                    parts.push(x.substr(lastIndex));
                } return parts;
            };
            const trimMessage = (messageSplit) => {
                let delivery = document.createElement('p');
                delivery.setAttribute('class', 'mb-0')
                for (let i = 0; i < messageSplit.length; i++) {
                    let tradeHack = 0;
                    let sample = document.createElement('span');
                    const msgSplitHasCommonTag = commonTag.test(messageSplit[i]);
                    const msgSplitHasRareTag = rareTag.test(messageSplit[i]);
                    const msgSplitHasEpicTag = epicTag.test(messageSplit[i]);
                    const msgSplitHasLegendaryTag = legendaryTag.test(messageSplit[i]);
                    const msgSplitHasMythicalTag = mythicalTag.test(messageSplit[i])
                    const msgSplitHasTradeTag = tradeTag.test(messageSplit[i]);
                    if (msgSplitHasCommonTag) {
                        sample.style.color = 'Aquamarine';
                        sample.textContent = `[${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}] (${(shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))] === '')? '100': shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))]})`;
                        sample.setAttribute('type','link');
                        sample.setAttribute('data-bs-toggle','tooltip');
                        sample.setAttribute('data-bs-html','true');
                        sample.setAttribute('data-bs-trigger','hover');
                        sample.setAttribute('data-bs-title',`<img src='https://kirka.lukeskywalk.com/static/renders/${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}-render.png' title='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'' alt='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'</img>`);
                    } else if (msgSplitHasRareTag) {
                        sample.style.color = 'Aqua';
                        sample.textContent = `[${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}] (${(shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))] === '')? '250': shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))]})`;
                        sample.setAttribute('type','link');
                        sample.setAttribute('data-bs-toggle','tooltip');
                        sample.setAttribute('data-bs-html','true');
                        sample.setAttribute('data-bs-trigger','hover');
                        sample.setAttribute('data-bs-title',`<img src='https://kirka.lukeskywalk.com/static/renders/${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}-render.png' title='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'' alt='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'</img>`);
                    } else if (msgSplitHasEpicTag) {
                        sample.style.color = 'BlueViolet'
                        sample.textContent = `[${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}] (${(shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))] === '')? '1000': shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))]})`;
                        sample.setAttribute('type','link');
                        sample.setAttribute('data-bs-toggle','tooltip');
                        sample.setAttribute('data-bs-html','true');
                        sample.setAttribute('data-bs-trigger','hover');
                        sample.setAttribute('data-bs-title',`<img src='https://kirka.lukeskywalk.com/static/renders/${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}-render.png' title='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'' alt='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'</img>`);
                    } else if (msgSplitHasLegendaryTag) {
                        sample.setAttribute('class', 'text-warning');
                        sample.textContent = `[${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}] (${(shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))] === '')? '5000': shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))]})`;
                        sample.setAttribute('type','link');
                        sample.setAttribute('data-bs-toggle','tooltip');
                        sample.setAttribute('data-bs-html','true');
                        sample.setAttribute('data-bs-trigger','hover');
                        sample.setAttribute('data-bs-title',`<img src='https://kirka.lukeskywalk.com/static/renders/${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}-render.png' title='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'' alt='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'</img>`);
                    } else if (msgSplitHasMythicalTag) {
                        sample.style.color = 'FireBrick';
                        sample.textContent = `[${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}] (${(shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))] === '')? '20000': shortItemsPrices[allItemsList.indexOf(messageSplit[i].slice(1,messageSplit[i].indexOf('|')))]})`;
                        sample.setAttribute('type','link');
                        sample.setAttribute('data-bs-toggle','tooltip');
                        sample.setAttribute('data-bs-html','true');
                        sample.setAttribute('data-bs-trigger','hover');
                        sample.setAttribute('data-bs-title',`<img src='https://kirka.lukeskywalk.com/static/renders/${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}-render.png' title='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'' alt='${messageSplit[i].slice(1,messageSplit[i].indexOf('|'))}'</img>`);
                    } else if (msgSplitHasTradeTag) {
                        let newSplit = messageSplit[i].trim().split('**');
                        tradeHack = 1;
                        let newSample = document.createElement('span');
                        let lastSample = document.createElement('span');
                        sample.textContent = `${newSplit[0]}**`;
                        delivery.appendChild(sample);
                        newSample.setAttribute('class','text-danger-emphasis stretched-link');
                        newSample.setAttribute('href',`javascript:;`);
                        newSample.setAttribute('role','button');
                        newSample.setAttribute('onclick',`copyClipboard('TRADE${preferences.nonce}')`);
                        newSample.setAttribute('id',`TRADE${preferences.nonce}`);
                        newSample.textContent = `${newSplit[1]}`;
                        delivery.appendChild(newSample);
                        lastSample.textContent = `**${newSplit[2]}`;
                        delivery.appendChild(lastSample);

                    } else {
                        sample.textContent = `${messageSplit[i]}`;
                    }
                    if (tradeHack === 0) {
                        delivery.appendChild(sample);
                    }                     
                }
                return delivery;
            };
            const settings = {
                url: 'wss://chat.kirka.io',
            };
            let preferences = {
                consoled: false,
                autoscroll: 1,
                nonce: 0,
                lastUser: null,
            };
            const autoscroll = () => {
                if (preferences.autoscroll === 1) {
                    preferences.autoscroll = 0;
                } else {
                    preferences.autoscroll = 1;
                }
                if (preferences.consoled === true) {
                    console.log({ autoscroll: preferences.autoscroll });
                }
            };
            let lastData = {
                timer: null,
            };
            const consoled = (x) => {
                if (preferences.consoled) {
                    console.log(`${new Date().toLocaleTimeString()} ${x}`);
                }
            };
            const errorToText = (code) => {
                switch (code) {
                    case '1001':
                        return 'server is down.';
                    case '1002':
                        return 'terminated, protocol error.';
                    case '1003':
                        return 'terminated, data error.';
                    case '1004':
                        return 'reserved.';
                    case '1005':
                        return 'no status code present.';
                    case '1006':
                        return 'connection closed abnormally.';
                    case '1007':
                        return 'terminated, inconsistent type of message.';
                    case '1008':
                        return 'terminated, received message violate policy.';
                    case '1009':
                        return 'terminated, message too big.';
                    case '1010':
                        return 'terminated, server not responding.';
                    case '1011':
                        return 'terminated, unexpected condition encountered.';
                    default:
                }
            };
            const copyClipboard = async (target) => {
                let range = document.createRange();
                range.selectNode(document.getElementById(target));
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);
                document.execCommand("copy");
                window.getSelection().removeAllRanges();
            };
            const testChated = () => {
                let delivery = { message: 'MUFASA_685#Q15D2K is offering [TEST||BODY|COMMON], [Galaxy|LAR|WEAPON_SKIN|EPIC], [Winter|Weatie|WEAPON_SKIN|RARE]x2, [Spectacular|AR-9|WEAPON_SKIN|LEGENDARY], [Pink Demon|M60|WEAPON_SKIN|MYTHICAL], [Fur|VITA|WEAPON_SKIN|EPIC], [Hardened|VITA|WEAPON_SKIN|EPIC] for [Black Metal 2.0|VITA|WEAPON_SKIN|LEGENDARY], type  **/trade accept 10848** to accept this offer', type: 2, user: null/*{ id: 'blabla',level: 669,name: 'testsubject',role: 'USER',shortId: 'BUBU4A'}*/ };
                chated(delivery);
            };
            const chated = (x) => {
                let nickname = (x.user === null) ? 'SERVER' : x.user?.name + ` [${x.user?.level}] `;
                if (x.user?.role === 'MODERATOR') {
                    nickname = 'âœ…' + nickname;
                }
                if (x.user?.role === 'ADMIN') {
                    nickname = 'ðŸ›¡ï¸' + nickname;
                }
                const msg = x.message;
                const msgSplit = trimsplit(msg);
                const userIsntServerAndIsLastPostedMessage = (x.user != null && x.user?.name === preferences.lastUser);
                if (userIsntServerAndIsLastPostedMessage) {
                    let oldMessage = document.getElementById(`ID${preferences.nonce - 1}`);
                    oldMessage.appendChild(trimMessage(msgSplit));
                    if (preferences.autoscroll === 1) {
                        document.getElementById('chatter').scrollIntoView(false);
                    }
                } else {
                    let div1 = document.createElement('div');
                    let divH = document.createElement('div');
                    const userIsServer = x.user === null;
                    if (userIsServer) {
                        div1.setAttribute('class', 'toast fade show mt-1 mb-1 col-sm-10 text-bg-secondary');
                    } else {
                        div1.setAttribute('class', 'toast fade show mt-1 mb-1 col-sm-10');
                    }
                    div1.style.width = '100%'
                    div1.setAttribute('aria-live', 'assertive');
                    div1.setAttribute('role', 'alert');
                    div1.setAttribute('aria-atomic', 'true');
                    div1.setAttribute('animate', 'true');
                    divH.setAttribute('class', 'toast-header');
                    let big = document.createElement('strong');
                    let small = document.createElement('small');
                    if (userIsServer) {
                        big.setAttribute('class', 'me-auto text-light');
                    } else {
                        big.setAttribute('class', 'me-auto');
                    }
                    let post = document.createElement('div');
                    const userIsModerator = (x.user?.role === 'MODERATOR');
                    const userIsAdmin = (x.user?.role === 'ADMIN');
                    if (userIsModerator) {
                        post.setAttribute('class', 'toast-body text-info mb-0');
                        post.setAttribute('id', `ID${preferences.nonce}`);
                    } else if (userIsAdmin) {
                        post.setAttribute('class', 'toast-body text-info mb-0');
                        post.setAttribute('id', `ID${preferences.nonce}`);
                    } else {
                        post.setAttribute('class', 'toast-body text-light mb-0');
                        post.setAttribute('id', `ID${preferences.nonce}`);
                    }
                    big.textContent = nickname;
                    let bigShortLink = document.createElement('span');
                    if (!userIsServer) {
                        bigShortLink.setAttribute('id', `USER${preferences.nonce}${x.user?.shortId}`);
                        bigShortLink.setAttribute('class', 'stretched-link text-secondary');
                        bigShortLink.setAttribute('href', `javascript:;`);
                        bigShortLink.setAttribute('role', 'button');
                        bigShortLink.setAttribute('onclick', `copyClipboard('USER${preferences.nonce}${x.user?.shortId}')`);
                        bigShortLink.textContent = `#${x.user?.shortId}`;
                    }
                    big.appendChild(bigShortLink);
                    small.textContent = new Date().toLocaleTimeString();
                    post.appendChild(trimMessage(msgSplit));
                    divH.appendChild(big);
                    divH.appendChild(small);
                    div1.appendChild(divH);
                    div1.appendChild(post);
                    document.getElementById('chatter').appendChild(div1);
                    preferences.nonce += 1;
                    preferences.lastUser = x.user?.name;
                    if (preferences.autoscroll === 1) {
                        document.getElementById('chatter').scrollIntoView(false);
                    }
                    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
                    const tooltipList3 = document.querySelectorAll(`[class='tooltip-inner']`);
                    const tooltipList4 = document.querySelectorAll(`[class='tooltip-arrow']`);
                    const hack1 = [...tooltipList3].map(tooltipTriggerEl2 => { if (preferences.autoscroll === 1) { tooltipTriggerEl2.hidden = true }});
                    const hack2 = [...tooltipList4].map(tooltipTriggerEl2 => { if (preferences.autoscroll === 1) { tooltipTriggerEl2.hidden = true }});
                    const hack0 = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
                }
            };
            chated({ type: 2, user: null, message: 'kirka.io chat connecting...' });
            var wsBm = null;
            const reconnecBm = () => {
                wsBm = new WebSocket(settings.url, "protocolOne");
                wsBm.onopen = function (event) {
                    clearInterval(lastData.timer);
                    chated({ type: 2, user: null, message: 'kirka.io chat connected.' });
                };
                wsBm.onerror = function (err) {
                    chated({ type: 2, user: null, message: `kirka.io chat encountered an error ${err}.` });
                    wsBm.close();
                }
                wsBm.onclose = function (event) {
                    chated({ type: 2, user: null, message: `kirka.io chat widget disconnected (${event.code}) ${errorToText(event.code)}. reconnecting...` });
                    wsBm = null;
                    //wsBm.close();
                    lastData.timer = setInterval(reconnecBm, 2500);
                };
                wsBm.onmessage = function (message) {
                    const delivery = JSON.parse(message.data);
                    if (delivery.type === 3) {
                        for (let i = delivery.messages.length - 1; i > -1; i--) {
                            chated(delivery.messages[i])
                        }
                    }
                    if (delivery.type !== 3) {
                        chated(delivery)
                    }
                    if (preferences.consoled === true) {
                        console.log(delivery);
                    }
                };
            };
            reconnecBm();
        </script>
    </div>
</body>
</html>
